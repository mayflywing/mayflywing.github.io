<!doctype html>
<html lang="en">

<head>
  <title>Route</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.4/jquery-confirm.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.4/jquery-confirm.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDJW4jsPlNKgv6jFm3B5Edp5ywgdqLWdmc&callback=initMap" async defer></script>
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.5.0/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.5.0/mapbox-gl.css' rel='stylesheet' />
</head>
<body>
  <div class="container-fluid">
    <!--nav-->
    <div class="container-fluid sticky-top">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="index.html">Auto Planner</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
              <span class="sr-only">(current)</span>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="recommend.html">Recommend</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="arrange.html">Plan</a>
            </li>
            <li class="nav-item">
              <a id="saved_trips" class="nav-link" href="#">Saved Trips</a>
            </li>
          </ul>
          <div class="row">
            <div id="userbuttons" style="display:none"></div>
            <img id="usericon" src="icon/account_circle-24px.svg" />
            <figcaption id="welcome_part">
            </figcaption>
          </div>

      </nav>
    </div>
    <!--modal 1-->
    <div class="modal fade" id="Moda1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Sign in</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="Username" class="col-form-label">Username:</label>
                <input name="required" type="text" class="form-control" id="Username">
              </div>
              <div class="form-group">
                <label for="Password" class="col-form-label">Password:</label>
                <input name="required" type="password" class="form-control" id="Password">
              </div>
          </div>
          <div class="modal-footer">
            <button name="close" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="sign_in">Sign in</a>
          </div>
          </form>
        </div>
      </div>
    </div>
    <!--modal 2-->
    <div class="modal fade" id="Moda2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Sign up</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="Email" class="col-form-label">Email:</label>
                <input name="required" type="text" class="form-control" id="Email">
              </div>
              <div class="form-group">
                <label for="Username" class="col-form-label">Username:</label>
                <input name="required" type="text" class="form-control" id="Username_">
              </div>
              <div class="form-group">
                <label for="Password" class="col-form-label">Password:</label>
                <input name="required" type="password" class="form-control" id="Password_"></textarea>
              </div>
              <div class="form-group">
                <label for="Confirm Password" class="col-form-label">Confirm Password:</label>
                <input type="password" class="form-control" id="ConfirmPassword"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button name="close" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="sign_up">Sign up</button>
          </div>
        </div>
      </div>
    </div>
  <!--End nav-->
    <!-- ShareModal -->
    <div class="modal fade" id="sharemodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Share with ...</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <table class="table table-borderless">
              <tbody>
                <tr>
                  <td align="center">
                    <img width=40px src="icon\facebook.svg" />
                  </td>
                  <td align="center">
                    <img width=40px src="icon\googleplus.svg" />
                  </td>
                  <td align="center">
                    <img width=40px src="icon\twitter.svg" />
                  </td>
                </tr>
                <tr>
                  <td align="center"><a href=# class="text-secondary">Facebook</a></td>
                  <td align="center"><a href=# class="text-secondary">Google+</a></td>
                  <td align="center"><a href=# class="text-secondary">Twitter</a></td>
                </tr>
              </tbody>

            </table>


          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
<!--End ShareModal-->
    <div class="container-fluied">
      <br>
      <div class="container-fluied">
        <div class="row">
          <div class="col-md-1 col-sm-1">
          </div>
          <div id="back" class="col-md-3 col-sm-2">
            <a class="text-dark" href=# onClick="javascript :history.back(-1);">
              <img src="icon\arrow_back-24px.svg" />
              <figcaption>Back</figcaption>
            </a>
          </div>
        </div>
      </div>

      <br>
      <table id="table1" style="width:90%;table-layout: fixed;" class="table table-hover" align="center">
        <caption style="caption-side:top;">
          <h4>Trip Outline</h4>
        </caption>
        <thead>
          <th>

          </th>
          <td id="share" align="right" data-toggle="modal" data-target="#sharemodal">
            Share your trip
            <img src="icon\share-24px.svg" id="showmore">
          </td>
        </thead>
        <tbody>
          <tr>
            <th width="30%" scope="row">Departure From:</th>
            <td id="start">Town A</td>
          </tr>
          <tr>
            <th scope="row">Arrive at:</th>
            <td id="end">Town B</td>
          </tr>
          <tr>
            <th scope="row">Total Distance :</th>
            <td id="total_distance">11 miles (17.7 kilometers)</td>
          </tr>
          <tr>
            <th scope="row">Detail : </th>
            <td>
              <table class="table table-borderless">
                <thead>
                  <th></th>
                  <th align=center>By car</th>
                  <th align=center>On foot</th>
                  <th align=center>Distance</th>
                </thead>
                <tbody id="detail_route">
                  <th scope="row">A-B</th>
                  <td align=center>1</td>
                  <td align=center>2</td>
                  <td align=center>0</td>
                </tbody>
              </table>


            </td>
          </tr>
          <tr>
            <th scope="row">
              Route:
            </th>
            <td id="route" style="word-wrap：break-word;word-break:break-all">Town A->Town B->Town C</td>
          </tr>
        </tbody>
      </table>
      <br>
      <div id="mapicon" align=center class="container-fluid">
        <img width="50px" src="icon\map-24px.svg">
        <figcation class="text-info">Show the route on map</figcaption>
      </div>

    <div id="routemap" class="container-fluied">
        <div id='map' style="width:100%;height:500px;"></div>
    </div>
  </div>
</div>
  <script type="text/javascript" src="assets/js/functions.js"></script>
  <script type="text/javascript" src="assets/js/getUrlParam.js"></script>
  <script type="text/javascript" src="Data\data.js"></script>
  <script>
  mapboxgl.accessToken = 'pk.eyJ1IjoibWF5Zmx5d2luZyIsImEiOiJjazNwYTlybWkwMTJkM2RwZTJlYWpuM2prIn0.IrQ8Z6PKG84Yr_VemvjuCA';
  var places = {
  "type": "FeatureCollection",
  "features": [{
  "type": "Feature",
  "properties": {
  "description": "Raffles City",
  "icon":"embassy"
  },
  "geometry": {
  "type": "Point",
  "coordinates": [103.85314730000005,1.29401]
  }
  }, {
  "type": "Feature",
  "properties": {
  "description": "St. Andrew’s Cathedral",
  "icon":"embassy"
  },
  "geometry": {
  "type": "Point",
  "coordinates": [103.85231499999998,1.292488]
  }
  }, {
  "type": "Feature",
  "properties": {
  "description": "Funan The IT Mall",
  "icon": "embassy"
  },
  "geometry": {
  "type": "Point",
  "coordinates": [103.85015240000007,1.2911354]
  }
  }, {
  "type": "Feature",
  "properties": {
  "description": "City Hall",
  "icon": "embassy"
  },
  "geometry": {
  "type": "Point",
  "coordinates": [103.85203760000002,1.2930838]
  }
  }, {
  "type": "Feature",
  "properties": {
  "description": "Old Parliament",
  "icon": "embassy"
  },
  "geometry": {
  "type": "Point",
  "coordinates": [103.85106380000002,1.2886837]
  }
  }]
  };

  var map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v8',
  center: [103.85314730000005, 1.29401],
  zoom: 15
  });

  map.on('load', function() {
  // Add a GeoJSON source containing place coordinates and information.
  map.addSource("places", {
  "type": "geojson",
  "data": places
  });

  map.addLayer({
  "id": "poi-labels",
  "type": "symbol",
  "source": "places",
  "layout": {
  "text-field": ["get", "description"],
  "text-variable-anchor": ["top", "bottom", "left", "right"],
  "text-radial-offset": 0.5,
  "text-justify": "auto",
  "icon-image": ["concat", ["get", "icon"], "-15"]
  }
  });
  });
  </script>


  <script type="text/javascript">
  //let a = __distance__["Ninenzaka and Sannenzaka"]["Fushimi Inari Shrine"][0]["distance"];
  //alert(a);
    $(function() {
      var count = 5;
      var arr = new Array("Raffles City","St. Andrew’s Cathedral","Funan The IT Mall","City Hall","Old Parliament");
      var dis = new Array("0.27km","0.3km","1km","0.55km");
      var car_time = new Array("1min","1min","3min","6min"); 
      var foot_time = new Array("5min","4min","5min","7min"); 
      var start = arr[0];
      var end = arr[count - 1];
      

      if (start != null) {
        $("#start").text(start);
      }
      if (end != null) {
        $("#end").text(end);
      }

      if (arr.length != 0) {
        var total_distance = 0;
        var str = "";
        var route = "";
        for (var i = 0; i < count; i++) {
          route += arr[i];
          if (i != count - 1) {
            route += "->";
          }
          if(i<count-1){
            var a = arr[i];
            var b = arr[i+1];
            var r = a+" -> "+b;
            var d = dis[i];
            total_distance+=parseFloat(d);
            var c = car_time[i];
            var f = foot_time[i];
            str+='<tr><th scope="row">'+r+'</th><td align=center>'+c+'</td><td align=center>'+f+'</td><td align=center>'+d+'</td></tr>';
          }
        }
        $("#route").text(route);
        $("#detail_route").html(str);
        $("#total_distance").html(total_distance+"km");
      }
    });

    //Show map
    $("#mapicon").click(function() {
      var H = $("#routemap").offset().top;
      $("html").animate({
        "scrollTop": H
      }, 800, );
    });

  </script>

</body>

</html>
